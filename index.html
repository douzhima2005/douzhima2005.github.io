<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>跑团风格诊断 - 结果页预览</title>
  <style>
    /* 全局变量与重置 
      您可以根据需要修改颜色变量
    */
    :root {
      --bg-color: #fcfcfc;
      --card-bg: #f2f0eb; /* 米色背景 */
      --card-border: 3px solid #4a4a4a; /* 深色粗边框 */
      --text-primary: #333333;
      --text-secondary: #666666;
      --accent-pink: #d4a5a5; /* 忙碌/标签颜色 */
      --accent-yellow: #e3cf8e; /* 空闲/标签颜色 */
      --accent-grey: #dcdcdc;
      --radius-lg: 24px;
      --radius-md: 12px;
      --font-main: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: var(--font-main);
      background-color: #e8ddd0; /* 外部背景色，模拟您的原网页 */
      display: flex;
      justify-content: center;
      padding: 20px;
      min-height: 100vh;
    }

    /* 主容器 */
    .result-container {
      width: 100%;
      max-width: 900px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    /* =========================================
       通用卡片样式
       ========================================= */
    .card {
      background-color: var(--card-bg);
      border: var(--card-border);
      border-radius: var(--radius-lg);
      padding: 24px;
      position: relative;
      /* 增加一点阴影让它更像卡片 */
      box-shadow: 4px 4px 0px rgba(0,0,0,0.1); 
    }

    /* =========================================
       顶部：名片区域
       ========================================= */
    .top-section {
      display: flex;
      gap: 30px;
      align-items: stretch;
      min-height: 280px;
    }

    /* 左侧头像 */
    .avatar-area {
      flex: 0 0 220px; /* 固定宽度 */
      border: 2px solid #333;
      border-radius: var(--radius-md);
      background-color: #fff;
      overflow: hidden;
      cursor: pointer;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: opacity 0.3s;
    }

    .avatar-area:hover .upload-hint {
      opacity: 1;
    }

    .avatar-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .upload-hint {
      position: absolute;
      background: rgba(0,0,0,0.6);
      color: white;
      padding: 5px 10px;
      border-radius: 4px;
      opacity: 0;
      transition: opacity 0.3s;
      pointer-events: none;
      font-size: 14px;
    }

    #file-input {
      display: none;
    }

    /* 右侧信息 */
    .info-area {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center; /* 居中对齐，如参考图 */
      text-align: center;
    }

    .player-id {
      font-size: 64px;
      font-weight: 900;
      color: #333;
      line-height: 1.2;
      border-bottom: 2px dashed transparent;
      margin-bottom: 5px;
      min-width: 150px;
    }

    .player-id:hover, .player-id:focus {
      border-bottom-color: #999;
      outline: none;
    }

    .player-title {
      font-size: 20px;
      letter-spacing: 4px;
      color: var(--accent-pink);
      font-weight: bold;
      margin-bottom: 20px;
    }

    .tags-row {
      display: flex;
      gap: 15px;
      margin-bottom: 30px;
    }

    .tag-pill {
      padding: 8px 24px;
      border-radius: 20px;
      color: #fff;
      font-weight: bold;
      font-size: 14px;
    }
    
    .tag-primary { background-color: var(--accent-pink); }
    .tag-secondary { background-color: var(--accent-yellow); color: #5a4a2d; }

    .quote-box {
      font-size: 14px;
      color: var(--text-secondary);
      max-width: 80%;
      font-style: italic;
      line-height: 1.6;
      padding: 10px;
      border: 1px dashed rgba(0,0,0,0.1);
      border-radius: 8px;
    }
    
    .quote-box:focus {
      outline: none;
      background: rgba(255,255,255,0.5);
    }

    /* =========================================
       底部：两列布局
       ========================================= */
    .bottom-section {
      display: grid;
      grid-template-columns: 1fr 1fr; /* 等分两列 */
      gap: 20px;
    }

    .section-title {
      font-size: 28px;
      font-weight: 900;
      color: #333;
      margin-bottom: 20px;
    }

    /* 左下：跑团履历 */
    .resume-content {
      display: flex;
      gap: 10px;
    }

    .resume-list {
      flex: 1;
      background: #e0e0e0; /* 灰色底 */
      border-radius: var(--radius-md);
      padding: 15px;
      min-height: 300px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .resume-item {
      background: transparent;
      border: none;
      border-bottom: 1px solid rgba(0,0,0,0.1);
      padding: 5px;
      font-size: 14px;
      color: #555;
      width: 100%;
      text-align: center;
      font-family: inherit;
    }
    .resume-item:focus {
      outline: none;
      background: rgba(255,255,255,0.5);
    }
    .resume-item::placeholder {
      color: #999;
    }

    /* 侧边气泡 */
    .side-bubbles {
      width: 100px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .bubble {
      padding: 15px 10px;
      border-radius: var(--radius-md);
      font-size: 12px;
      line-height: 1.4;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .bubble-grey {
      background-color: #e6e6e6;
      color: #666;
      flex: 1; /* 占据上半部分 */
    }

    .bubble-pink {
      background-color: var(--accent-pink);
      color: white;
      flex: 1; /* 占据下半部分 */
    }

    .editable-area:focus {
      outline: none;
      background-color: rgba(255,255,255,0.2);
    }

    /* 右下：日程安排 */
    .calendar-header-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .legend {
      display: flex;
      gap: 15px;
      font-size: 12px;
      color: #666;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      padding: 4px 8px;
      border-radius: 4px;
      transition: transform 0.1s, background-color 0.2s;
      border: 1px solid transparent;
    }
    
    .legend-item:hover {
      background-color: rgba(0,0,0,0.05);
    }

    /* 选中状态样式 */
    .legend-item.active {
      background-color: #fff;
      border-color: #999;
      transform: scale(1.05);
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .dot {
      width: 16px;
      height: 16px;
      border-radius: 4px;
      display: inline-block;
    }
    .dot.free { background-color: var(--accent-yellow); }
    .dot.busy { background-color: var(--accent-pink); }

    .calendar-grids-container {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .month-block {
      /* 每个月的块 */
    }

    .month-title {
      font-size: 14px;
      color: #888;
      margin-bottom: 8px;
      font-weight: bold;
    }

    .cal-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 6px;
    }

    .cal-cell {
      aspect-ratio: 1;
      background-color: #e0e0e0; /* 默认灰色 */
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      color: #fff;
      cursor: pointer;
      transition: background-color 0.2s;
      user-select: none;
    }

    .cal-cell:hover {
      opacity: 0.8;
    }
    
    .cal-cell.empty {
      background-color: transparent;
      cursor: default;
    }

    /* 染色状态 */
    .cal-cell.status-free {
      background-color: var(--accent-yellow);
      color: #5a4a2d;
      font-weight: bold;
    }

    .cal-cell.status-busy {
      background-color: var(--accent-pink);
      color: white;
      font-weight: bold;
    }

    /* =========================================
       移动端适配
       ========================================= */
    @media (max-width: 768px) {
      .top-section {
        flex-direction: column;
        align-items: center;
        height: auto;
      }
      .avatar-area {
        width: 160px;
        height: 160px;
        flex: none;
      }
      .info-area {
        width: 100%;
      }
      .bottom-section {
        grid-template-columns: 1fr; /* 变为单列 */
      }
      .resume-content {
        flex-direction: row; /* 保持行，或者也可以改成列 */
      }
    }
  </style>
</head>
<body>

  <div class="result-container">
    
    <!-- 1. 顶部名片卡片 -->
    <div class="card top-section">
      <!-- 左侧：头像上传 -->
      <div class="avatar-area" onclick="document.getElementById('file-input').click()">
        <!-- 默认显示的图片/占位符 -->
        <img id="avatar-preview" class="avatar-img" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23ddd'/%3E%3Ctext x='50' y='50' font-family='Arial' font-size='14' fill='%23888' text-anchor='middle' dy='.3em'%3E点击上传头像%3C/text%3E%3C/svg%3E" alt="Avatar">
        <div class="upload-hint">点击更换</div>
        <input type="file" id="file-input" accept="image/*">
      </div>

      <!-- 右侧：信息 -->
      <div class="info-area">
        <!-- 可编辑ID -->
        <div class="player-id" contenteditable="true" spellcheck="false">心中</div>
        <!-- 职位/称号 -->
        <div class="player-title">剧情诡术师</div>
        <!-- 标签 -->
        <div class="tags-row">
          <div class="tag-pill tag-primary">战术指挥官</div>
          <div class="tag-pill tag-secondary">创造者</div>
        </div>
        <!-- 签名/描述 -->
        <div class="quote-box" contenteditable="true" spellcheck="false">
          “我不是在骗NPC，我是在为我们的HE制造一点无伤大雅的戏剧性波折。”
        </div>
      </div>
    </div>

    <!-- 底部区域 -->
    <div class="bottom-section">
      
      <!-- 2. 左下：跑团履历 -->
      <div class="card">
        <h3 class="section-title">跑团履历</h3>
        <div class="resume-content">
          <div class="resume-list">
            <!-- 生成一些默认的输入框 -->
            <input type="text" class="resume-item" placeholder="点击输入模组名称..." value="《厄舍学校》">
            <input type="text" class="resume-item" placeholder="点击输入模组名称..." value="《莫索里哀的圣职者》">
            <input type="text" class="resume-item" placeholder="点击输入模组名称..." value="《天衔纪年》">
            <input type="text" class="resume-item" placeholder="点击输入模组名称..." value="《极道》">
            <input type="text" class="resume-item" placeholder="点击输入模组名称...">
            <input type="text" class="resume-item" placeholder="点击输入模组名称...">
            <input type="text" class="resume-item" placeholder="点击输入模组名称...">
            <input type="text" class="resume-item" placeholder="点击输入模组名称...">
            <input type="text" class="resume-item" placeholder="点击输入模组名称...">
          </div>
          
          <div class="side-bubbles">
            <div class="bubble bubble-grey editable-area" contenteditable="true">
              喜欢跑COJ<br>PL/KP皆可<br>跑过的就可以带
            </div>
            <div class="bubble bubble-pink editable-area" contenteditable="true">
              雷点：<br>不请假失踪；<br>频繁鸽子；<br>工事已读不回。
            </div>
          </div>
        </div>
      </div>

      <!-- 3. 右下：日程安排 -->
      <div class="card">
        <div class="calendar-header-row">
          <h3 class="section-title" style="margin-bottom: 0;">日程安排</h3>
          <div class="legend">
            <!-- 增加 active 类来指示当前选中的工具 -->
            <div class="legend-item" id="tool-free" onclick="selectTool('free')">
              <span class="dot free"></span> 空闲
            </div>
            <div class="legend-item" id="tool-busy" onclick="selectTool('busy')">
              <span class="dot busy"></span> 忙碌
            </div>
          </div>
        </div>

        <div class="calendar-grids-container" id="calendar-container">
          <!-- 日历将由 JS 动态生成 -->
        </div>
      </div>

    </div>
  </div>

  <script>
    // ===========================
    // 1. 头像上传功能
    // ===========================
    const fileInput = document.getElementById('file-input');
    const avatarPreview = document.getElementById('avatar-preview');

    fileInput.addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          avatarPreview.src = e.target.result;
        }
        reader.readAsDataURL(file);
      }
    });

    // ===========================
    // 2. 日历生成与交互逻辑
    // ===========================
    let currentTool = null; // 当前选中的工具：'free' | 'busy' | null

    function selectTool(toolType) {
      // 如果点击已选中的，则取消选中
      if (currentTool === toolType) {
        currentTool = null;
        document.querySelectorAll('.legend-item').forEach(el => el.classList.remove('active'));
        return;
      }
      
      currentTool = toolType;
      // 更新UI选中状态
      document.querySelectorAll('.legend-item').forEach(el => el.classList.remove('active'));
      document.getElementById('tool-' + toolType).classList.add('active');
    }

    function renderCalendar() {
      const container = document.getElementById('calendar-container');
      const now = new Date();
      
      // 生成当前月和下个月
      for (let i = 0; i < 2; i++) {
        const year = now.getFullYear();
        const month = now.getMonth() + i; // JS会自动处理月份溢出（例如11+1变成次年0月）
        
        // 创建日期对象以获取信息
        const dateObj = new Date(year, month, 1);
        const displayYear = dateObj.getFullYear();
        const displayMonth = dateObj.getMonth(); // 0-11
        const monthName = displayMonth + 1 + '月';

        // 计算该月第一天是周几
        const firstDayIndex = dateObj.getDay(); // 0(周日) - 6(周六)
        // 计算该月有多少天
        const daysInMonth = new Date(displayYear, displayMonth + 1, 0).getDate();

        // 创建DOM结构
        const monthBlock = document.createElement('div');
        monthBlock.className = 'month-block';
        
        const title = document.createElement('div');
        title.className = 'month-title';
        title.textContent = monthName;
        monthBlock.appendChild(title);

        const grid = document.createElement('div');
        grid.className = 'cal-grid';

        // 填充空白（上个月的）
        for (let j = 0; j < firstDayIndex; j++) {
          const emptyCell = document.createElement('div');
          emptyCell.className = 'cal-cell empty';
          grid.appendChild(emptyCell);
        }

        // 填充日期
        for (let day = 1; day <= daysInMonth; day++) {
          const cell = document.createElement('div');
          cell.className = 'cal-cell';
          cell.textContent = day;
          
          // 点击事件
          cell.addEventListener('click', function() {
            if (!currentTool) return; // 如果没选工具，不操作

            // 如果当前已经有这个状态，则取消（toggle）
            // 如果是不同的状态，则覆盖
            const targetClass = 'status-' + currentTool;
            
            // 移除所有状态
            if (this.classList.contains(targetClass)) {
              this.classList.remove(targetClass);
            } else {
              this.classList.remove('status-free', 'status-busy');
              this.classList.add(targetClass);
            }
          });

          grid.appendChild(cell);
        }

        monthBlock.appendChild(grid);
        container.appendChild(monthBlock);
      }
    }

    // 初始化日历
    renderCalendar();

  </script>
</body>
</html>